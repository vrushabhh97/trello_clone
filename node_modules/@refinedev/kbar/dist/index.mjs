"use client"
var nt=Object.defineProperty;var r=(n,e)=>nt(n,"name",{value:e,configurable:!0});import W,{createContext as St}from"react";import{KBarProvider as vt}from"kbar";import{KBAR_LISTBOX as Be,KBarAnimator as Ie,KBarContext as Ce,KBarPortal as Se,KBarPositioner as ve,KBarProvider as Pe,KBarResults as we,KBarSearch as Te,NO_GROUP as ke,Priority as De,VisualState as Le,createAction as Ee,getListboxItemId as ze,useKBar as Ne,useMatches as Me,useRegisterActions as Ue}from"kbar";import{useEffect as G,useState as ot,useContext as it}from"react";import{useNavigation as at,useDelete as rt,useTranslate as st,useResource as pt,useCanWithoutCache as ct,useUserFriendlyName as lt,useRouterType as dt,useGo as mt}from"@refinedev/core";import{useRegisterActions as ft,createAction as u,KBarContext as yt,VisualState as bt}from"kbar";var g=r(n=>n.replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()),"capitalize");import{useGetToPath as gt}from"@refinedev/core";var I=r(()=>{let n=st(),{resource:e,resources:p,id:c,action:y}=pt(),l=dt(),d=gt(),b=mt(),{mutate:H}=rt(),{push:K,list:Pt,create:wt,show:Tt,edit:kt}=at(),V=lt(),$=it(yt),{can:a}=ct(),[B,q]=ot([]);G(()=>{r(async()=>await Promise.all(F().flatMap(i=>_(i))),"preaparedActions")().then(i=>q(i.flatMap(m=>m)))},[p,c,e,y]),G(()=>{B.length===0&&$.query.setVisualState(bt.hidden)},[B]);let F=r(()=>{let t=[...p],i=t==null?void 0:t.findIndex(m=>(m.identifier??(m==null?void 0:m.name))===((e==null?void 0:e.identifier)??(e==null?void 0:e.name)));if(i>0){let m=t[i];t.splice(i,1),t.splice(0,0,m)}return t},"moveActionToFirst"),_=r(async t=>{var L,E,z,N,M,U;let{name:i,label:m,list:j,create:T,canCreate:Q,canEdit:X,canShow:J,icon:Y,show:k,canDelete:Z,edit:D,route:Dt}=t,tt=((L=t==null?void 0:t.meta)==null?void 0:L.label)??((E=t==null?void 0:t.options)==null?void 0:E.label)??m,h=((z=t==null?void 0:t.meta)==null?void 0:z.icon)??((N=t==null?void 0:t.options)==null?void 0:N.icon)??Y,et=((M=t==null?void 0:t.meta)==null?void 0:M.canDelete)??((U=t==null?void 0:t.options)==null?void 0:U.canDelete)??Z,A=tt??n(`${t.name}.${t.name}`,V(t.name,"plural")),x=[];if(j&&(e!==void 0&&(e==null?void 0:e.name)!==i||y!==void 0&&(e==null?void 0:e.name)===i)){let{can:f}=await(a==null?void 0:a({resource:i,action:"list",params:{id:c,resource:t}}))||{can:!0};f&&x.push(u({name:n("actions.list",g("list")),section:A,icon:h,perform:()=>{let o=d({resource:t,action:"list",legacy:l==="legacy"});o&&(l==="legacy"?K(o):b({to:o}))}}))}if((Q||T)&&T&&(y!=="create"||(e==null?void 0:e.name)!==i)){let{can:f}=await(a==null?void 0:a({resource:i,action:"create",params:{resource:t}}))||{can:!0};f&&x.push(u({name:n("actions.create",g("create")),section:A,icon:h,keywords:"new",perform:()=>{let o=d({resource:t,action:"create",legacy:l==="legacy"});o&&(l==="legacy"?K(o):b({to:o}))}}))}if((e==null?void 0:e.name)===i&&c){if((J||k)&&k&&y!=="show"){let{can:f}=await(a==null?void 0:a({resource:i,action:"show",params:{id:c,resource:t}}))||{can:!0};f&&x.push(u({name:n("actions.show",g("show")),section:A,icon:h,perform:()=>{let o=d({resource:t,action:"show",legacy:l==="legacy",meta:{id:c}});o&&(l==="legacy"?K(o):b({to:o}))}}))}if((X||D)&&D&&y!=="edit"){let{can:f}=await(a==null?void 0:a({resource:i,action:"edit",params:{id:c,resource:t}}))||{can:!0};f&&x.push(u({name:n("actions.edit",g("edit")),section:A,icon:h,perform:()=>{let o=d({resource:t,action:"edit",legacy:l==="legacy",meta:{id:c}});o&&(l==="legacy"?K(o):b({to:o}))}}))}if(et){let{can:f}=await(a==null?void 0:a({resource:i,action:"delete",params:{id:c,resource:t}}))||{can:!0};f&&x.push({id:"delete",name:n("actions.delete",g("delete")),section:A,icon:h},u({name:n("buttons.delete",g("delete")),section:n("buttons.confirm","Are you sure?"),parent:"delete",perform:()=>{H({resource:t.name,id:c},{onSuccess:()=>{let o=d({resource:t,action:"list",legacy:l==="legacy"});o&&(l==="legacy"?K(o):b({to:o}))}})}}),u({name:n("buttons.cancel","Cancel"),parent:"delete",perform:()=>null}))}}return x},"createActionWithResource");ft(B,[B])},"useRefineKbar");import R from"react";import{KBarPortal as xt,KBarPositioner as ut,KBarAnimator as Kt,KBarSearch as ht}from"kbar";var S=r(()=>R.createElement(xt,null,R.createElement(ut,{style:{opacity:1,transition:"background 0.35s cubic-bezier(0.4, 0, 0.2, 1) 0s",backdropFilter:"saturate(180%) blur(1px)",background:"rgba(0, 0, 0, 0.1)",zIndex:"9999"}},R.createElement(Kt,{style:{maxWidth:"600px",width:"100%",background:"white",color:"black",borderRadius:"8px",overflow:"hidden",boxShadow:"0px 4px 4px rgba(0, 0, 0, 0.25)"}},R.createElement(ht,{style:{padding:"12px 16px",fontSize:"16px",width:"100%",boxSizing:"border-box",outline:"none",border:"none",background:"rgb(252 252 252)",color:"black"}}),R.createElement(v,null)))),"CommandBar");import P from"react";import{KBarResults as At,useMatches as Rt}from"kbar";var Bt={padding:"8px 16px",fontSize:"14px",textTransform:"uppercase",fontWeight:"bold",opacity:.5},v=r(()=>{let{results:n,rootActionId:e}=Rt();return P.createElement(At,{items:n,onRender:({item:p,active:c})=>typeof p=="string"?P.createElement("div",{style:Bt},p):P.createElement(C,{action:p,active:c,currentRootActionId:e})})},"RenderResults");import s from"react";var C=s.forwardRef(({action:n,active:e,currentRootActionId:p},c)=>{var l;let y=s.useMemo(()=>{if(!p)return n.ancestors;let d=n.ancestors.findIndex(b=>b.id===p);return n.ancestors.slice(d+1)},[n.ancestors,p]);return s.createElement("div",{ref:c,style:{padding:"12px 16px",background:e?"rgba(0 0 0 / 0.05)":"transparent",borderLeft:`2px solid ${e?"rgb(28 28 29)":"transparent"}`,display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"}},s.createElement("div",{style:{display:"flex",gap:"8px",alignItems:"center",fontSize:14}},n.icon&&n.icon,s.createElement("div",{style:{display:"flex",flexDirection:"column"}},s.createElement("div",null,y.length>0&&y.map(d=>s.createElement(s.Fragment,{key:d.id},s.createElement("span",{style:{opacity:.5,marginRight:8}},d.name),s.createElement("span",{style:{marginRight:8}},"\u203A"))),s.createElement("span",{style:{color:n.name.toLocaleUpperCase()==="DELETE"?"red":"black"}},n.name)),n.subtitle&&s.createElement("span",{style:{fontSize:12}},n.subtitle))),(l=n.shortcut)!=null&&l.length?s.createElement("div",{"aria-hidden":!0,style:{display:"grid",gridAutoFlow:"column",gap:"4px"}},n.shortcut.map(d=>s.createElement("kbd",{key:d,style:{padding:"4px 6px",background:"rgba(0 0 0 / .1)",borderRadius:"4px",fontSize:14}},d))):null)});C.displayName="ResultItem";import It,{useContext as Ct}from"react";var O=r(({commandBarProps:n})=>{let e=Ct(w);I();let p={...e,...n};return It.createElement(S,{...p})},"RefineKbar");var w=St({}),he=r(({children:n,commandBarProps:e})=>W.createElement(w.Provider,{value:e??{}},W.createElement(vt,null,n)),"RefineKbarProvider");export{Be as KBAR_LISTBOX,Ie as KBarAnimator,Ce as KBarContext,Se as KBarPortal,ve as KBarPositioner,Pe as KBarProvider,we as KBarResults,Te as KBarSearch,ke as NO_GROUP,De as Priority,O as RefineKbar,w as RefineKbarPropsContext,he as RefineKbarProvider,Le as VisualState,Ee as createAction,ze as getListboxItemId,Ne as useKBar,Me as useMatches,I as useRefineKbar,Ue as useRegisterActions};
//# sourceMappingURL=index.mjs.map